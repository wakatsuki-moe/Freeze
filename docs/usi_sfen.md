# Freeze将棋拡張 案
* 2020-11-29：初版
* 2020-12-02：改定
* 2020-12-22: 改定

## 基本;^^
* 「F or f」は既にsfenである(6筋)ので　「Z or z」 ;^^
  * sfen拡張
    * 基本 lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1
      * 最後に付加
      * 残り回数  zxxZxx
        * lnsgkg略sSNL b - 1  z3Z3
        * z 先手残り回数     Z 後手残り回数
        * 無ければ 先後共に0回 考慮しない(通常)
      * 局面
        * Freeze局面なら付随
          * した zx (xは駒種)
          * lnsgkg…sSNL b - 1 zG z2Z3
            * コノ局面でフリーズ金 先手２回、後手３回
        * フリーズされた局面なら付随(オプション?)
          * された Zx(xは駒種)
          * lnsgkg…sSNL w - 1 ZG z3Z2
            * フリーズ金された局面から 先手3回後手2回

## USI拡張
  FREEZE (NONE | ALLOW_FREEZE | CAN_FREEZE | OK)
  FREEZENUM zNZN (FREEZE OK 以外は無視)

  * FREEZE オプション
    * NONE (デフォルト)
      * フリーズ将棋 受け入れない

    * ALLOW_FREEZE
      * AIは、フリーズ将棋は受け入れる(がAIからはフリーズの指し手に含めない)

    * CAN_FREEZE
      * AIは、フリーズ将棋の指し手を指す(が相手からのフリーズの指し手を受け入れない)

    * OK
      * ALLOW_FREEZE かつ  CAN_FREEZE(フリーズ将棋は受け入れ、かつ、フリーズ将棋の指し手を指す)
    * FREEZENUM zNZM
       * 先手zN回数後手ZM回数
       * 指定無けれは デフォルト先後 3回づつ

## 指し手

 * 基本１ position startpos
 *  基本２ position sfen xxxxxxxxxx moves xx zG ・・・ z3Z3
    * 残り回数  zxxZxx
      * position startpos z3Z3
      * position startpos moves xx ・・・ z3Z3
        * z 先手残り回数     Z 後手残り回数
        * 無ければ 先後共に0回 考慮しない(通常)

* 基本 7g7f
  * 7g7fzG
    * 7g7f 移動で金をフリーズ
  * 7g7fZG (オプション)
    *  金がフリーズの局面で思考し、指し手7g7f
  * info で表示するか bestmoveで示すか pv等で示すか
      * info
        * info depth 1 seldepth 1 score cp 6055 nodes 137 nps 10538 time 13 pv ・・・5c6czG
          * 読みで 5c6c移動で金をフリーズ
        * info depth 1 seldepth 1 score cp 6055 nodes 137 nps 10538 time 13 pv ・・・ 5c6czG  ・・
          * 読みでの途中で 5c6c移動で金をフリーズ
        * info depth 1 seldepth 1 score cp 6055 nodes 137 nps 10538 time 13 pv ・・・ 5c6cZG  ・・
          *  読みでの途中で 金がフリーズの局面で思考し 5c6c移動 (オプション)

    * bestmove
        * bestmove 5c6czG
          * 金をフリーズ で 5c6c移動
        * bestmove 5c6czG ponder xxxx
          * 金をフリーズ で 5c6c移動de で XXXを先読み
        * bestmove 5c6c ponder xxxxzG
          * 5c6c移動 で 先読みで xxxx移動で 金をフリーズ
        * bestmove 5c6cZG (オプション)
          * 金がフリーズの局面で、指し手 5c6c移動

---

* 棋譜

  * コメントでも良いかと

    * ダメ＞＜ 現状、将棋神 でだと、コメントは読み込むけど、表示せず、保存するとコメントは全て消えちゃう><
    * どうしようか；
      * なんとかする;^^

  * ※ 当面はkif/kifu( か、ki2/ki2u) 形式  sfen(USI)形式 のみ ^^;



---
##  棋譜フォーマット

```raw

#KIF version=2.0 encoding=UTF-8
# ---- Kifu for Windows V7 V7.41 棋譜ファイル ----
開始日時：2019/05/29(水)
表題：【テスト配信】綾瀬綾Presents新感覚将棋【Freeze！将棋（フリーズ将棋）】VS エクトリアちゃん
棋戦：フリーズ将棋(テスト配信)
場所：将棋ウォーズ
手合割：平手　　
先手：綾瀬綾
後手：エクトリア
#Freeze 先手 x回 後手 x回 (←コメント扱い 他のGUIでも読める)
手数----指手---------消費時間--
1 ５六歩(57)   ( 0:00/00:00:00)
2 ４二銀(31)   ( 0:00/00:00:00)
3 ５八飛(28)   ( 0:00/00:00:00)
4 ５二飛(82)   ( 0:00/00:00:00)
5 ７六歩(77)   ( 0:00/00:00:00)
6 ６二銀(71)   ( 0:00/00:00:00)
7 ４八玉(59)   ( 0:00/00:00:00)
8 ３二金(41)   ( 0:00/00:00:00)
9 ３八玉(48)   ( 0:00/00:00:00)
10 ７二金(61)   ( 0:00/00:00:00)

・・・案１
40 ４六角(24)   ( 0:00/00:00:00)
*z金 先手3回 後手2回 (←フリーズ コメント扱い 他のGUIでも読める)
41 ３七銀(38)   ( 0:00/00:00:00)
*Z金 先手3回 後手2回 (←被フリーズ コメント扱い 他のGUIでも読める)
・・・


・・・  案３
63 同　金(48)   (0:00/00:00:00) (先手3回 後手2回)        (←通常の指し手)
64 ４五桂打     (0:00/00:00:00) (z金 先手3回 後手2回)  (←フリーズ )
65 同　銀(56)   (0:00/00:00:00) (Z金 先手3回 後手2回)  (←被フリーズ)
・・・

```


##  フリーズ分岐棋譜 (変化：上記と同様)

```raw

・・・ 案1b
変化：4手
4 同　銀(71)    (00:00 / 00:00:00)
*z金 先手3回 後手2回 (←フリーズ コメント扱い    他のGUIでも読める)
5 ６一金打      (00:00 / 00:00:00)
*Z金 先手3回 後手2回 (←被フリーズ コメント扱い 他のGUIでも読める)
・・・

・・・案3b
変化：4手
4 同　銀(71)    (00:00 / 00:00:00) (z金 先手3回 後手2回)  (←フリーズ )
5 ６一金打      (00:00 / 00:00:00) (Z金 先手3回 後手2回)  (←被フリーズ)
・・・

```


##  フリーズ局面

```raw

#KIF version=2.0 encoding=UTF-8
# KIF形式棋譜ファイル
# Generated by Shogidokoro
# Freeze 先手 x回 後手 y回 (←コメント扱い フリーズ将棋の時のみ 他のGUIでも読める)
後手の持駒：なし
９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
|v香v桂 ・v金 ・ ・ ・v桂v香|一
| ・v玉v銀 ・ ・v飛 ・ ・ ・|二
| ・ ・ ・v金v歩v銀v角v歩v歩|三
|v歩v歩v歩v歩 ・v歩v歩 ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ 歩 歩 ・ ・ 歩 歩 歩|六
| 歩 歩 桂 銀 歩 歩 ・ 銀 ・|七
| 香 ・ ・ 角 飛 金 金 玉 香|八
| ・ ・ ・ ・ ・ ・ ・ 桂 ・|九
+---------------------------+
先手の持駒：なし
先手：人間
後手：人間
#Freeze z歩 先手 x回 後手 y回   (←コメント扱い フリーズの時         回数は上記の初期設定への上書き)
#Freeze Z歩 先手 x回 後手 y回   (←コメント扱い フリーズ局面の時     回数は上記の初期設定への上書き)
#Freeze z 先手 x回 後手 y回     (←コメント扱い フリーズ局面で無い時 回数は上記の初期設定への上書き)
(他のGUIでも読める)
手数----指手---------消費時間--

```

  ##  sfen

  * 上記参照を
